<!DOCTYPE html>
<html lang="en">


<head>
    <script data-main="js/recoverybarSelected" src="js/lib/require.js"></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content=""><meta name="author" content="">

    <title>Enovia Client</title>


    <link href="css/buttons.dataTables.min.css" rel="stylesheet">
    <link href="css/jquery.dataTables.min.css" rel="stylesheet">

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/dashboard.css" rel="stylesheet">
    <link href="css/datepicker.css" rel="stylesheet">
    <link href="css/jquery.timepicker.min.css"  rel="stylesheet">
    <link href="css/plm-cursor.css" rel="stylesheet">

    <style>
    td.details-control {
    	background: url('images/details_open.png') no-repeat center center;
    	cursor: pointer;
	}
	tr.shown td.details-control {
    	background: url('images/details_close.png') no-repeat center center;
	}

	/*PER LOADING SCREEN:*/
	.overlay{
    display: none;
    position: fixed;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    z-index: 999;
    background: rgba(255,255,255,0.8) url("images/loader.gif") center no-repeat;
    }
    /* Turn off scrollbar when body element has the loading class */
    body.loading{
        overflow: hidden;
    }
    /* Make spinner image visible when body element has the loading class */
    body.loading .overlay{
        display: block;
    }
    </style>

    <!--[if lt IE 9]>
    <script src="js/lib/ie8-responsive-file-warning.js"></script>
    <![endif]-->
    <script src="js/lib/ie-emulation-modes-warning.js"></script>
    <!--//--><!--[if lt IE 9]>
    <script src="js/lib/html5shiv.min.js"></script>
    <script src="js/lib/respond.min.js"></script>
    <![endif]-->
</head>
<body>

<script src="js/jquery.min.js"></script>
<script src="js/jquery.dataTables.min.js"></script>

<script src="js/buttons.flash.min.js"></script>
<script src="js/buttons.print.min.js"></script>
<script src="js/dataTables.buttons.min.js"></script>
<script src="js/jszip.min.js"></script>
<script src="js/pdfmake.js"></script>
<script src="js/vfs_fonts.js"></script>
<script src="js/buttons.html5.min.js"></script>
<script src="js/dataTables.fixedHeader.min.js"></script>
<script src="js/dataTables.select.min.js"></script>



<script>
	$(document).ready(function()  {
	
		var table = $('#example').DataTable( {
	               "scrollCollapse": true,
	               "paging": false,
	               //"scrollY": "550px",
	               //"scrollX": true,
	               "order": [[2, 'asc']],
	               "info": true,
	               "stateSave": true,
	               "paging": false,
	               "bPaginate": false,
	               "fixedHeader": {
	                   "header": true,
	                   "footer": true
	               },
	               "select": {
	                    "style": "multi"
	                },
	               "oLanguage": {
	                   "sInfo" : "Showing _TOTAL_ entries ",// Showing _START_ to _END_ of _TOTAL_ entries
	                },
	               "destroy": true,
	          	   "dom": "Bfrtip",
                   "drawCallback": function( settings ) {
                         updateTopBar();
                    },
			  "buttons": [
			              "copy", "csv", "excel", "pdf", "print",

                            {
                                "text": "Select all",
                                "action": function () {
                                    table.rows().select();
                                }
                            },
                            {
                                "text": "Select none",
                                "action": function () {
                                    table.rows().deselect();
                                }
                            },
			               {
                                "text": "Get selected data",
                                 "action": function () {
                                    //Recupero indici righe selezionate
                                    var selectedRows = table.rows( { selected: true } ).indexes();

                                    var selectedRows1 = table.rows( { selected: true } ).data().toArray();
                                    console.log("Selected Values:");
                                    console.log(selectedRows1);
                                    var json = JSON.stringify( selectedRows1 );

                                    //Recupero chiavi da Table Header
                                    //var header = table.columns().header().map(x => x.innerHTML).toArray();
                                    var header = ["A","B","C","D","E","F","G"];
                                    console.log("Header Keys:");
                                    console.log(header);

                                    //Test Map Object
                                    convertToJSONObject(header, selectedRows1);

                                    //Recupero colonna 0 dagli indici
                                    var names = table.cells(selectedRows, 1).data().toArray();
                                    createCallbackJSON("PIPPO", names)
                                    //Per ogni nome recupero valore
                                    /*names.each( function ( value, index ) {
                                        recovery(value);
                                    } );*/
                                 }
                            }
        				]
		} );

		table.buttons( [ 5, 6, 7 ] ).nodes().css("background", "red");

        //In selezione e deselezione aggiorno top bar
        table.on( 'select', function ( e, dt, type, indexes ) {
            updateTopBar();
        } );
        table.on( 'deselect', function ( e, dt, type, indexes ) {
            updateTopBar();
        } );

	} );

    function recovery(name) {
        console.log("Selezionato nome: " + name);
    };

    function updateTopBar(){
        if ($( "#example_info_topbar" ).length) {
            // element already exist
            $( "#example_info_topbar" ).remove();
        }
        $('#example_info').clone(true).attr("id", "example_info_topbar").insertBefore($('#example'));
    };

    function convertToJSONObject(keys, values){
        var myarray = [];
        for (var x = 0; x < values.length; x++) {
            var objRow = {};
            for (var i = 0; i < keys.length; i++) {
              var name = keys[i];
              var value = values[x][i];
              objRow[name] = value;
            }
            myarray.push(objRow);
        }
        var json = JSON.stringify( myarray );
        console.log("JSON Obj:");
        console.log(json);
    }

    function createCallbackJSON(methodName, ids){
        var myObj = {};
        myObj["function"] = methodName;
        myObj["ids"] = ids;
        console.log(myObj);
    }

    function ajaxStart(){
        $("body").addClass("loading");
    }
    function ajaxStop(){
        $("body").removeClass("loading");
    }
 	</script>


<a href="http://blog.redturtle.it/2013/01/22/datatable.js-tabelle-per-tutti-i-gusti">Info</a>.



<table id="example" class="display" style="width:100%">
    <thead>
    <tr>
        <th>Info</th>
        <th>Name</th>
        <th>Position</th>
        <th>Office</th>
        <th>Age</th>
        <th>Start date</th>
        <th>Salary</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="details-control"></td>
        <td>Tiger Nixon</td>
        <td>System Architect</td>
        <td>Edinburgh</td>
        <td>61</td>
        <td>2011/04/25</td>
        <td>$320,800</td>
    </tr>
    <tr>
        <td class="details-control"></td>
        <td>Garrett Winters</td>
        <td>Accountant</td>
        <td>Tokyo</td>
        <td>63</td>
        <td>2011/07/25</td>
        <td>$170,750</td>
    </tr>
    <tr>
        <td class="details-control"></td>
        <td>Ashton Cox</td>
        <td>Junior Technical Author</td>
        <td>San Francisco</td>
        <td>66</td>
        <td>2009/01/12</td>
        <td>$86,000</td>
    </tr>
    <tr>
        <td class="details-control"></td>
        <td>Cedric Kelly</td>
        <td>Senior Javascript Developer</td>
        <td>Edinburgh</td>
        <td>22</td>
        <td>2012/03/29</td>
        <td>$433,060</td>
    </tr>
    <tr>
        <td class="details-control"></td>
        <td>Cedric </td>
        <td>Senior  Developer</td>
        <td>Busto</td>
        <td>20</td>
        <td>2012/03/29</td>
        <td>$500,060</td>
    </tr>
    <tr>
        <td class="details-control"></td>
        <td>Conte </td>
        <td>Developer</td>
        <td>Legnano</td>
        <td>20</td>
        <td>2012/03/29</td>
        <td>$500,060</td>
    </tr>
    </tbody>
    <tfoot>
    <tr>
        <th>Info</th>
        <th>Name</th>
        <th>Position</th>
        <th>Office</th>
        <th>Age</th>
        <th>Start date</th>
        <th>Salary</th>
    </tr>
    </tfoot>
</table>
<div class="overlay"></div>
</body>
</html>